<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>SSR - RiotJS Isomorphic Stack</title>
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "SSR";
    var mkdocs_page_input_path = "server_rendering.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/javascript.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <!-- Place this tag in your head or just before your close body tag. -->
  <script async defer src="https://buttons.github.io/buttons.js"></script>
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">

    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <!-- <br> -->
        <img src="../img/logo-white.png" class="normal-img" style="width: 80% !important;"/>
        <!-- <a href=".." class="icon icon-home"> RiotJS Isomorphic Stack</a> -->
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Introduction</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">SSR</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#layouts">Layouts</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#fetching-data">Fetching data</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#components-state">Component's state</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#server-sent-state">Server sent state</a>
    </li>
    </ul>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../routing/">Routing</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../api/">API</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../utils/">Utils</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../plugins/">Plugins</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../config/">Configuration</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">RiotJS Isomorphic Stack</a>
      </nav>
      
      
      
      <div class="wy-nav-content">
        
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>SSR</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/nesterow/frontless-docs/edit/master/docs/server_rendering.md"
        data-icon="octicon-eye"
        data-size="small"
          class="github-button"> Edit on GitHub</a>
      
      <a class="github-button" href="https://github.com/nesterow/frontless" data-size="small" data-show-count="true" aria-label="Star Frontless on GitHub">
          Star
      </a>
      <!-- Place this tag where you want the button to render. -->
      <!-- <a class="github-button" href="https://github.com/nesterow/frontless/fork" data-icon="octicon-repo-forked" data-size="small" aria-label="Fork ntkme/github-buttons on GitHub">Fork</a> -->
      <!-- <a href="https://h5l5o.sse.codesandbox.io/" target="_blank" >
        <img src="https://img.shields.io/badge/CodeSandbox-â–¶-green.svg"></img>
      </a> -->
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="ssr">SSR</h1>
<p>The pages in Frontless are rendered after all fetch operations in children components are complete. 
Which means you can make asyncronous queries in children components and don't worry that the server return markup before data is fetched.</p>
<h2 id="layouts">Layouts</h2>
<p>Frontless uses <a href="https://ejs.co/">ejs</a> to render page layouts. The layouts located inside <code>pages/layouts</code> directory.
In order to render your page with specific layout just include corresponding property to the root component. 
By default Frontless uses <code>base</code> layout.</p>
<p>Example:</p>
<pre><code class="javascript">export default {
  layout: 'base'
}
</code></pre>

<h2 id="fetching-data">Fetching data</h2>
<p>Whenever a riot component has the <code>fetch</code> method returning a Promise, the server will wait until it resolves. </p>
<p>Example:</p>
<pre><code class="javascript">export default {
  async fetch(props){
    const data = await someDbQuery()
    this.update(data) 
  }
}
</code></pre>

<h2 id="components-state">Component's state</h2>
<p>It doesn't matter whether you change compenents <code>state</code> on the server side or in the browser. 
The initial state of the components on the client side will resolve to the last component's state on the server side. </p>
<h2 id="server-sent-state">Server sent state</h2>
<p>Some API requests can return a ready view-model for a specific component. After it happens, the target component will update its state from received response. This is convenient whenever you want to update the view after a request is done. Given that, the server should return a ready view-model which eliminates extra steps you would do to handle response.</p>
<p>Normally, you should follow 3 steps to make it work:</p>
<p>Give your component an unique id:</p>
<pre><code class="javascript">export default {
  id: 'message', // target id
  state: {
    message:''
  }
  ...
}
</code></pre>

<p>Then, on the server side use method <code>app.setState()</code> to compose a response:</p>
<pre><code class="javascript">app.use('myservice',{
    async create(data){
      return app.setState('message', {
        message: 'Hello!'
      })
    }
})
</code></pre>

<p>After that, whenever you call <code>myservice</code> the component <code>message</code> will automatically update on response.</p>
<pre><code class="javascript">client.service('myservice').create({})
</code></pre>

<p>Notice that you don't need to handle API call as the server supposed to return ready view-model for your component. The UI will update automatically. However, you still nedd to handle loading states and errors.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../routing/" class="btn btn-neutral float-right" title="Routing">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href=".." class="btn btn-neutral" title="Introduction"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/nesterow/frontless-docs/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../routing/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script type="text/javascript" defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
